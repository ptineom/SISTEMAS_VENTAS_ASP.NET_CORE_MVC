"use strict";var oModalAbono={init:function(){},seleccionado:!1,resolve:null,reject:null,fechaEmision:"",fechaVencimiento:"",show:function(n,t){let e=n.total.split(" ")[0],o=n.abono==0?"":n.abono,s=n.saldo==0?"":oHelper.formatoMoneda(e,n.saldo,2);oModalAbono.fechaEmision=n.fechaEmision;oModalAbono.fechaCancelacion=n.fechaCancelacion;let h=`<div class="modal fade" id="modalAbono" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" >
                        <div class="modal-dialog modal-sm">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" ><i class="bi bi-cash-stack"></i> Abono</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <form  method="post" id="form-abono">
                                        <div class="row">
                                            <div class="col-12">
                                                <label class="form-label mb-1">Monto total</label>
                                                <input class="form-control form-control-sm text-end" value='${n.total}' type="text" disabled id="txtTotalModalAbono">
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label mb-1">Saldo</label>
                                                <input class="form-control form-control-sm text-end" value='${s}' type="text" disabled id="txtSaldoModalAbono">
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label mb-1">Monto a abonar</label>
                                                <input class="form-control form-control-sm text-end" name='txtAbono' value='${o}' type="text" autocomplete="off" id="txtAbonoModalAbono">
                                            </div>
                                            <div class="col-12">
                                                <label class="form-label mb-1">Fecha a cancelar</label>
                                                <div class="input-group input-group-sm date">
                                                    <span class="input-group-text" id="basic-addon2"><i class="bi bi-calendar-check"></i></span>
                                                    <input type="text" class="form-control date-picker" name='txtFechaModalAbono' value='${oModalAbono.fechaCancelacion}' id="txtFechaModalAbono" data-date-format="dd/mm/yyyy" autocomplete="off">
                                                </div>
                                             </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal"><i class="bi bi-box-arrow-left"></i> Salir</button>
                                    <button type="button" class="btn btn-success" id="btnGuardarModalAbono"><i class="bi bi-save2"></i> Guardar cambios</button>
                                </div>
                            </div>
                        </div>
                    </div>`,c=document.getElementById("content"),r=c.querySelector("main");r.insertAdjacentHTML("afterbegin",h);let i=document.getElementById("modalAbono"),u=new bootstrap.Modal(i,{});i.addEventListener("shown.bs.modal",function(){document.getElementById("txtAbonoModalAbono").focus()});i.addEventListener("hidden.bs.modal",function(){oModalAbono.seleccionado||oModalAbono.reject(t);oModalAbono.fechaEmision="";oModalAbono.fechaCancelacion="";oModalAbono.seleccionado=!1;r.removeChild(i)});document.getElementById("btnGuardarModalAbono").addEventListener("click",()=>{$("#form-abono").valid()&&(oModalAbono.resolve({abono:parseFloat(document.getElementById("txtAbonoModalAbono").value),saldo:parseFloat(oHelper.numeroSinMiles(document.getElementById("txtSaldoModalAbono").value).split(" ")[1]),fechaCancelacion:document.getElementById("txtFechaModalAbono").value}),oModalAbono.seleccionado=!0,u.hide())});let f=document.getElementById("txtAbonoModalAbono");return f.addEventListener("input",n=>{let i=n.target.value;i=i==""?0:i;let r=document.getElementById("txtTotalModalAbono"),t=oHelper.numeroSinMiles(r.value),u=t.split(" ")[0];t=t.split(" ")[1];t=new Decimal(t);let f=t.minus(i).toNumber();document.getElementById("txtSaldoModalAbono").value=oHelper.formatoMoneda(u,f,2)}),f.addEventListener("keypress",n=>oHelper.numerosDecimales(n)),oConfigControls.inicializarDatePicker("#modalAbono .date-picker"),oModalAbono.validaciones(),u.show(),new Promise((n,t)=>{oModalAbono.resolve=n,oModalAbono.reject=t})},validaciones:function(){$.validator.addMethod("notEmptyAndZero",function(n){return n==0?!1:!0},"Ingrese el monto a abonar.");$.validator.addMethod("notOlderDateExpiration",function(n){let t=dayjs(oModalAbono.fechaVencimiento,"DD/MM/YYYY");return dayjs(n,"DD/MM/YYYY").isAfter(t)?!1:!0},"La fecha ingresada no debe ser mayor a la fecha de vencimiento.");$.validator.addMethod("notLessDateIssue",function(n){let t=dayjs(oModalAbono.fechaEmision,"DD/MM/YYYY");return dayjs(n,"DD/MM/YYYY").isBefore(t)?!1:!0},"La fecha ingresada no debe ser menor a la fecha de emisi√≥n");$("#form-abono").validate({rules:{txtFechaModalAbono:{required:!0,notOlderDateExpiration:!0,notLessDateIssue:!0},txtAbono:{notEmptyAndZero:!0}},messages:{txtAbono:{},txtFechaModalAbono:{required:"Debe de seleccionar la fecha a cancelar."}}})}};